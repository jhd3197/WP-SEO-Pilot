"use strict";(globalThis.webpackChunkwp_seo_pilot_assets=globalThis.webpackChunkwp_seo_pilot_assets||[]).push([[879],{226(e,t,a){a.d(t,{A:()=>n});var l=a(609);const n=({tabs:e,activeTab:t,onChange:a,ariaLabel:n})=>(0,l.createElement)("div",{className:"sub-tabs",role:"tablist","aria-label":n},e.map(e=>(0,l.createElement)("button",{key:e.id,type:"button",role:"tab",className:"sub-tab "+(t===e.id?"is-active":""),"aria-selected":t===e.id,onClick:()=>a(e.id)},e.label)))},263(e,t,a){a.d(t,{A:()=>c});var l=a(609);const n=(e,t,a)=>{if("undefined"==typeof window)return t;const l=new URL(window.location.href).searchParams.get(a);return l&&e.some(e=>e.id===l)?l:t},c=({tabs:e,defaultTab:t,paramName:a="tab"})=>{const[c,s]=(0,l.useState)(()=>n(e,t,a));return(0,l.useEffect)(()=>{const l=()=>{s(n(e,t,a))};return window.addEventListener("popstate",l),()=>window.removeEventListener("popstate",l)},[e,t,a]),[c,t=>{if(!e.some(e=>e.id===t))return;if(s(t),"undefined"==typeof window)return;const l=new URL(window.location.href);l.searchParams.set(a,t),window.history.replaceState({},"",l.toString())}]}},879(e,t,a){a.r(t),a.d(t,{default:()=>y});var l=a(609),n=a(87),c=a(455),s=a.n(c),r=a(226),o=a(263);const i=[{id:"rules",label:"Rules"},{id:"categories",label:"Categories"},{id:"utm-templates",label:"UTM Templates"},{id:"settings",label:"Settings"}],m=["h1","h2","h3","h4","h5","h6"],u=({rules:e,rulesLoading:t,categories:a,templates:n,selectedRules:c,filterStatus:s,filterCategory:r,filterSearch:o,bulkAction:i,bulkCategory:m,onFilterStatus:u,onFilterCategory:d,onFilterSearch:p,onSelectAll:E,onSelectRule:g,onEditRule:h,onDeleteRule:v,onToggleRule:y,onDuplicateRule:b,onBulkAction:N,onBulkCategory:k,onApplyBulk:_,onAddRule:f,getCategoryById:C,getTemplateById:w})=>{const S=s||r||o;return(0,l.createElement)("section",{className:"panel"},(0,l.createElement)("div",{className:"table-toolbar"},(0,l.createElement)("div",null,(0,l.createElement)("h3",null,"Linking Rules"),(0,l.createElement)("p",{className:"muted"},"Define keywords and their target URLs for automatic linking.")),(0,l.createElement)("button",{type:"button",className:"button primary",onClick:f},"Add Rule")),(0,l.createElement)("div",{className:"filters-bar"},(0,l.createElement)("div",{className:"filters-bar__filters"},(0,l.createElement)("select",{value:s,onChange:e=>u(e.target.value)},(0,l.createElement)("option",{value:""},"All statuses"),(0,l.createElement)("option",{value:"active"},"Active"),(0,l.createElement)("option",{value:"inactive"},"Inactive")),(0,l.createElement)("select",{value:r,onChange:e=>d(e.target.value)},(0,l.createElement)("option",{value:""},"All categories"),a.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name))),(0,l.createElement)("input",{type:"search",placeholder:"Search rules...",value:o,onChange:e=>p(e.target.value)}),S&&(0,l.createElement)("button",{type:"button",className:"link-button",onClick:()=>{u(""),d(""),p("")}},"Clear"))),t?(0,l.createElement)("div",{className:"loading-state"},"Loading rules..."):0===e.length?(0,l.createElement)("div",{className:"empty-state"},(0,l.createElement)("div",{className:"empty-state__icon"},(0,l.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",width:"48",height:"48"},(0,l.createElement)("path",{d:"M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"}),(0,l.createElement)("path",{d:"M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"}))),(0,l.createElement)("h3",null,S?"No rules match your filters":"No linking rules yet"),(0,l.createElement)("p",null,S?"Try adjusting your filters.":"Create your first internal link rule to get started."),!S&&(0,l.createElement)("button",{type:"button",className:"button primary",onClick:f},"Create Rule")):(0,l.createElement)(l.Fragment,null,(0,l.createElement)("table",{className:"data-table"},(0,l.createElement)("thead",null,(0,l.createElement)("tr",null,(0,l.createElement)("th",{className:"check-column"},(0,l.createElement)("input",{type:"checkbox",checked:c.length===e.length&&e.length>0,onChange:E})),(0,l.createElement)("th",null,"Title"),(0,l.createElement)("th",null,"Category"),(0,l.createElement)("th",null,"Keywords"),(0,l.createElement)("th",null,"Destination"),(0,l.createElement)("th",null,"Status"),(0,l.createElement)("th",null,"Actions"))),(0,l.createElement)("tbody",null,e.map(e=>{const t=C(e.category);return(0,l.createElement)("tr",{key:e.id},(0,l.createElement)("td",{className:"check-column"},(0,l.createElement)("input",{type:"checkbox",checked:c.includes(e.id),onChange:()=>g(e.id)})),(0,l.createElement)("td",null,(0,l.createElement)("strong",null,(0,l.createElement)("button",{type:"button",className:"link-button",onClick:()=>h(e)},e.title))),(0,l.createElement)("td",null,t?(0,l.createElement)("span",{className:"category-pill",style:{"--pill-color":t.color}},t.name):(0,l.createElement)("span",{className:"muted"},"—")),(0,l.createElement)("td",null,(0,l.createElement)("span",{className:"keywords-preview"},(e.keywords||[]).slice(0,3).join(", "),(e.keywords||[]).length>3&&(0,l.createElement)("span",{className:"muted"}," +",e.keywords.length-3))),(0,l.createElement)("td",null,e.destination_url?(0,l.createElement)("a",{href:e.destination_url,target:"_blank",rel:"noopener noreferrer",className:"destination-link"},e.destination_label):(0,l.createElement)("span",{className:"muted"},"—")),(0,l.createElement)("td",null,(0,l.createElement)("span",{className:"pill "+("active"===e.status?"success":"muted")},"active"===e.status?"Active":"Inactive")),(0,l.createElement)("td",null,(0,l.createElement)("div",{className:"action-buttons"},(0,l.createElement)("button",{type:"button",className:"link-button",onClick:()=>h(e)},"Edit"),(0,l.createElement)("button",{type:"button",className:"link-button",onClick:()=>b(e.id)},"Duplicate"),(0,l.createElement)("button",{type:"button",className:"link-button",onClick:()=>y(e.id)},"active"===e.status?"Deactivate":"Activate"),(0,l.createElement)("button",{type:"button",className:"link-button danger",onClick:()=>v(e.id)},"Delete"))))}))),c.length>0&&(0,l.createElement)("div",{className:"bulk-actions"},(0,l.createElement)("span",{className:"bulk-actions__count"},c.length," selected"),(0,l.createElement)("select",{value:i,onChange:e=>N(e.target.value)},(0,l.createElement)("option",{value:""},"Bulk actions"),(0,l.createElement)("option",{value:"activate"},"Activate"),(0,l.createElement)("option",{value:"deactivate"},"Deactivate"),(0,l.createElement)("option",{value:"change_category"},"Change category"),(0,l.createElement)("option",{value:"delete"},"Delete")),"change_category"===i&&(0,l.createElement)("select",{value:m,onChange:e=>k(e.target.value)},(0,l.createElement)("option",{value:"__none__"},"Remove category"),a.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name))),(0,l.createElement)("button",{type:"button",className:"button",onClick:_,disabled:!i},"Apply"))))},d=({categories:e,templates:t,onEdit:a,onDelete:n,onAdd:c})=>(0,l.createElement)("section",{className:"panel"},(0,l.createElement)("div",{className:"table-toolbar"},(0,l.createElement)("div",null,(0,l.createElement)("h3",null,"Rule Categories"),(0,l.createElement)("p",{className:"muted"},"Group rules, pick a color, and set per-category limits.")),(0,l.createElement)("button",{type:"button",className:"button primary",onClick:c},"Add Category")),0===e.length?(0,l.createElement)("div",{className:"empty-state"},(0,l.createElement)("h3",null,"No categories yet"),(0,l.createElement)("p",null,"Create categories to organize your linking rules."),(0,l.createElement)("button",{type:"button",className:"button primary",onClick:c},"Create Category")):(0,l.createElement)("table",{className:"data-table"},(0,l.createElement)("thead",null,(0,l.createElement)("tr",null,(0,l.createElement)("th",null,"Name"),(0,l.createElement)("th",null,"Color"),(0,l.createElement)("th",null,"Default UTM"),(0,l.createElement)("th",null,"Cap"),(0,l.createElement)("th",null,"Rules"),(0,l.createElement)("th",null,"Actions"))),(0,l.createElement)("tbody",null,e.map(e=>{const c=(s=e.default_utm,t.find(e=>e.id===s));var s;return(0,l.createElement)("tr",{key:e.id},(0,l.createElement)("td",null,(0,l.createElement)("strong",null,e.name),e.description&&(0,l.createElement)("div",{className:"muted small"},e.description)),(0,l.createElement)("td",null,(0,l.createElement)("span",{className:"color-chip",style:{backgroundColor:e.color}})),(0,l.createElement)("td",null,c?c.name:(0,l.createElement)("span",{className:"muted"},"—")),(0,l.createElement)("td",null,e.category_cap||(0,l.createElement)("span",{className:"muted"},"—")),(0,l.createElement)("td",null,e.rule_count||0),(0,l.createElement)("td",null,(0,l.createElement)("div",{className:"action-buttons"},(0,l.createElement)("button",{type:"button",className:"link-button",onClick:()=>a(e)},"Edit"),(0,l.createElement)("button",{type:"button",className:"link-button danger",onClick:()=>n(e.id)},"Delete"))))})))),p=({templates:e,onEdit:t,onDelete:a,onAdd:n})=>(0,l.createElement)("section",{className:"panel"},(0,l.createElement)("div",{className:"table-toolbar"},(0,l.createElement)("div",null,(0,l.createElement)("h3",null,"UTM Templates"),(0,l.createElement)("p",{className:"muted"},"Define reusable parameter sets for consistent tracking.")),(0,l.createElement)("button",{type:"button",className:"button primary",onClick:n},"Add Template")),0===e.length?(0,l.createElement)("div",{className:"empty-state"},(0,l.createElement)("h3",null,"No UTM templates yet"),(0,l.createElement)("p",null,"Create templates to add tracking parameters to your links."),(0,l.createElement)("button",{type:"button",className:"button primary",onClick:n},"Create Template")):(0,l.createElement)("table",{className:"data-table"},(0,l.createElement)("thead",null,(0,l.createElement)("tr",null,(0,l.createElement)("th",null,"Name"),(0,l.createElement)("th",null,"utm_source"),(0,l.createElement)("th",null,"utm_medium"),(0,l.createElement)("th",null,"utm_campaign"),(0,l.createElement)("th",null,"Apply to"),(0,l.createElement)("th",null,"Mode"),(0,l.createElement)("th",null,"Actions"))),(0,l.createElement)("tbody",null,e.map(e=>(0,l.createElement)("tr",{key:e.id},(0,l.createElement)("td",null,(0,l.createElement)("strong",null,e.name)),(0,l.createElement)("td",null,e.utm_source||(0,l.createElement)("span",{className:"muted"},"—")),(0,l.createElement)("td",null,e.utm_medium||(0,l.createElement)("span",{className:"muted"},"—")),(0,l.createElement)("td",null,e.utm_campaign||(0,l.createElement)("span",{className:"muted"},"—")),(0,l.createElement)("td",null,(e=>{switch(e){case"internal":return"Internal only";case"external":return"External only";default:return"Both"}})(e.apply_to)),(0,l.createElement)("td",null,(e=>{switch(e){case"always_overwrite":return"Always overwrite";case"never":return"Never overwrite";default:return"Append if missing"}})(e.append_mode)),(0,l.createElement)("td",null,(0,l.createElement)("div",{className:"action-buttons"},(0,l.createElement)("button",{type:"button",className:"link-button",onClick:()=>t(e)},"Edit"),(0,l.createElement)("button",{type:"button",className:"link-button danger",onClick:()=>a(e.id)},"Delete")))))))),E=({settings:e,onChange:t,onSave:a})=>{const n=(a,l)=>{t({...e,[a]:l})};return(0,l.createElement)("section",{className:"panel"},(0,l.createElement)("div",{className:"table-toolbar"},(0,l.createElement)("div",null,(0,l.createElement)("h3",null,"Module Settings"),(0,l.createElement)("p",{className:"muted"},"Configure how internal links are applied to your content."))),(0,l.createElement)("div",{className:"settings-section"},(0,l.createElement)("h4",{className:"settings-section__title"},"Global Defaults"),(0,l.createElement)("div",{className:"settings-row compact"},(0,l.createElement)("div",{className:"settings-label"},(0,l.createElement)("label",{htmlFor:"default-max-links"},"Default max links per page"),(0,l.createElement)("p",{className:"settings-help"},"0 means no limit.")),(0,l.createElement)("div",{className:"settings-control"},(0,l.createElement)("input",{id:"default-max-links",type:"number",min:"0",max:"50",value:e.default_max_links_per_page||0,onChange:e=>n("default_max_links_per_page",parseInt(e.target.value,10)||0),style:{width:"80px"}}))),(0,l.createElement)("div",{className:"settings-row compact"},(0,l.createElement)("div",{className:"settings-label"},(0,l.createElement)("label",null,"Default heading behavior"),(0,l.createElement)("p",{className:"settings-help"},"Control whether links can appear in headings.")),(0,l.createElement)("div",{className:"settings-control"},(0,l.createElement)("div",{className:"radio-group"},["none","selected","all"].map(t=>(0,l.createElement)("label",{key:t,className:"radio-item"},(0,l.createElement)("input",{type:"radio",name:"heading_behavior",value:t,checked:e.default_heading_behavior===t,onChange:()=>n("default_heading_behavior",t)}),(0,l.createElement)("span",null,t.charAt(0).toUpperCase()+t.slice(1))))),"selected"===e.default_heading_behavior&&(0,l.createElement)("div",{className:"checkbox-group",style:{marginTop:"8px"}},m.map(t=>(0,l.createElement)("label",{key:t,className:"checkbox-item"},(0,l.createElement)("input",{type:"checkbox",checked:(e.default_heading_levels||[]).includes(t),onChange:()=>(t=>{const a=e.default_heading_levels||[];a.includes(t)?n("default_heading_levels",a.filter(e=>e!==t)):n("default_heading_levels",[...a,t])})(t)}),(0,l.createElement)("span",null,t.toUpperCase()))))))),(0,l.createElement)("div",{className:"settings-section"},(0,l.createElement)("h4",{className:"settings-section__title"},"Safeties"),(0,l.createElement)("div",{className:"settings-row compact"},(0,l.createElement)("div",{className:"settings-label"},(0,l.createElement)("label",{htmlFor:"avoid-existing"},"Avoid replacing inside existing links")),(0,l.createElement)("div",{className:"settings-control"},(0,l.createElement)("label",{className:"toggle"},(0,l.createElement)("input",{id:"avoid-existing",type:"checkbox",checked:e.avoid_existing_links,onChange:e=>n("avoid_existing_links",e.target.checked)}),(0,l.createElement)("span",{className:"toggle-track"})))),(0,l.createElement)("div",{className:"settings-row compact"},(0,l.createElement)("div",{className:"settings-label"},(0,l.createElement)("label",{htmlFor:"word-boundaries"},"Prefer word boundaries")),(0,l.createElement)("div",{className:"settings-control"},(0,l.createElement)("label",{className:"toggle"},(0,l.createElement)("input",{id:"word-boundaries",type:"checkbox",checked:e.prefer_word_boundaries,onChange:e=>n("prefer_word_boundaries",e.target.checked)}),(0,l.createElement)("span",{className:"toggle-track"})))),(0,l.createElement)("div",{className:"settings-row compact"},(0,l.createElement)("div",{className:"settings-label"},(0,l.createElement)("label",{htmlFor:"normalize-accents"},"Normalize accents/diacritics")),(0,l.createElement)("div",{className:"settings-control"},(0,l.createElement)("label",{className:"toggle"},(0,l.createElement)("input",{id:"normalize-accents",type:"checkbox",checked:e.normalize_accents,onChange:e=>n("normalize_accents",e.target.checked)}),(0,l.createElement)("span",{className:"toggle-track"}))))),(0,l.createElement)("div",{className:"settings-section"},(0,l.createElement)("h4",{className:"settings-section__title"},"Performance"),(0,l.createElement)("div",{className:"settings-row compact"},(0,l.createElement)("div",{className:"settings-label"},(0,l.createElement)("label",{htmlFor:"cache-content"},"Cache rendered content")),(0,l.createElement)("div",{className:"settings-control"},(0,l.createElement)("label",{className:"toggle"},(0,l.createElement)("input",{id:"cache-content",type:"checkbox",checked:e.cache_rendered_content,onChange:e=>n("cache_rendered_content",e.target.checked)}),(0,l.createElement)("span",{className:"toggle-track"})))),(0,l.createElement)("div",{className:"settings-row compact"},(0,l.createElement)("div",{className:"settings-label"},(0,l.createElement)("label",{htmlFor:"chunk-docs"},"Chunk long documents"),(0,l.createElement)("p",{className:"settings-help"},"Prevents timeouts on large content.")),(0,l.createElement)("div",{className:"settings-control"},(0,l.createElement)("label",{className:"toggle"},(0,l.createElement)("input",{id:"chunk-docs",type:"checkbox",checked:e.chunk_long_documents,onChange:e=>n("chunk_long_documents",e.target.checked)}),(0,l.createElement)("span",{className:"toggle-track"}))))),(0,l.createElement)("div",{className:"panel-footer"},(0,l.createElement)("button",{type:"button",className:"button primary",onClick:a},"Save Settings")))},g=({rule:e,categories:t,templates:a,onClose:c,onSave:r})=>{const o=!!e,[i,m]=(0,n.useState)(()=>e?{...e}:{title:"",category:"",keywords:[],destination:{type:"post",post:0,url:""},utm_template:"inherit",attributes:{nofollow:!1,new_tab:!1},limits:{max_page:1},status:"active"}),[u,d]=(0,n.useState)(""),[p,E]=(0,n.useState)(""),[g,h]=(0,n.useState)([]),[v,y]=(0,n.useState)(null),[b,N]=(0,n.useState)(!1),[k,_]=(0,n.useState)("");(0,n.useEffect)(()=>{e&&"post"===e.destination?.type&&e.destination?.post&&y({id:e.destination.post,title:e.destination_label||"Loading..."})},[e]),(0,n.useEffect)(()=>{if(p.length<2)return void h([]);const e=setTimeout(async()=>{try{const e=await s()({path:`/wpseopilot/v2/internal-links/search-posts?search=${encodeURIComponent(p)}`});e.success&&h(e.data)}catch(e){console.error("Post search failed:",e)}},300);return()=>clearTimeout(e)},[p]);const f=(e,t)=>m(a=>({...a,[e]:t})),C=(e,t,a)=>m(l=>({...l,[e]:{...l[e],[t]:a}})),w=()=>{const e=u.trim();e&&!i.keywords.includes(e)&&(f("keywords",[...i.keywords,e]),d(""))};return(0,l.createElement)("div",{className:"modal-overlay",onClick:c},(0,l.createElement)("div",{className:"modal modal--large",onClick:e=>e.stopPropagation()},(0,l.createElement)("div",{className:"modal__header"},(0,l.createElement)("h2",null,o?"Edit Rule":"Add Rule"),(0,l.createElement)("button",{type:"button",className:"modal__close",onClick:c},"×")),(0,l.createElement)("form",{onSubmit:async t=>{t.preventDefault(),_(""),N(!0);try{const t=o?`/wpseopilot/v2/internal-links/rules/${e.id}`:"/wpseopilot/v2/internal-links/rules",a=await s()({path:t,method:o?"PUT":"POST",data:i});a.success?r(a.data):_(a.message||"Failed to save rule")}catch(e){_(e.message||"Failed to save rule")}finally{N(!1)}}},(0,l.createElement)("div",{className:"modal__body"},k&&(0,l.createElement)("div",{className:"form-error"},k),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",{htmlFor:"rule-title"},"Title"),(0,l.createElement)("input",{id:"rule-title",type:"text",value:i.title,onChange:e=>f("title",e.target.value),placeholder:"e.g., Link to Services page",required:!0})),(0,l.createElement)("div",{className:"form-row"},(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",{htmlFor:"rule-category"},"Category"),(0,l.createElement)("select",{id:"rule-category",value:i.category,onChange:e=>f("category",e.target.value)},(0,l.createElement)("option",{value:""},"None"),t.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name)))),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",null,"Status"),(0,l.createElement)("label",{className:"toggle"},(0,l.createElement)("input",{type:"checkbox",checked:"active"===i.status,onChange:e=>f("status",e.target.checked?"active":"inactive")}),(0,l.createElement)("span",{className:"toggle-track"})))),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",null,"Destination"),(0,l.createElement)("div",{className:"radio-group",style:{marginBottom:"12px"}},(0,l.createElement)("label",{className:"radio-item"},(0,l.createElement)("input",{type:"radio",name:"destination_type",checked:"post"===i.destination.type,onChange:()=>C("destination","type","post")}),(0,l.createElement)("span",null,"Post/Page")),(0,l.createElement)("label",{className:"radio-item"},(0,l.createElement)("input",{type:"radio",name:"destination_type",checked:"url"===i.destination.type,onChange:()=>C("destination","type","url")}),(0,l.createElement)("span",null,"Custom URL"))),"post"===i.destination.type?v?(0,l.createElement)("div",{className:"selected-post"},(0,l.createElement)("span",null,v.title),(0,l.createElement)("button",{type:"button",className:"link-button",onClick:()=>{y(null),C("destination","post",0)}},"Change")):(0,l.createElement)("div",{className:"post-search"},(0,l.createElement)("input",{type:"text",placeholder:"Search posts...",value:p,onChange:e=>E(e.target.value)}),g.length>0&&(0,l.createElement)("ul",{className:"post-search__results"},g.map(e=>(0,l.createElement)("li",{key:e.id},(0,l.createElement)("button",{type:"button",onClick:()=>(e=>{y(e),C("destination","post",e.id),C("destination","type","post"),E(""),h([])})(e)},e.title," ",(0,l.createElement)("span",{className:"muted"},"(",e.post_type,")")))))):(0,l.createElement)("input",{type:"url",value:i.destination.url,onChange:e=>C("destination","url",e.target.value),placeholder:"https://example.com"})),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",null,"Keywords"),(0,l.createElement)("div",{className:"tag-input"},(0,l.createElement)("div",{className:"tag-input__tags"},i.keywords.map(e=>(0,l.createElement)("span",{key:e,className:"tag"},e,(0,l.createElement)("button",{type:"button",onClick:()=>(e=>f("keywords",i.keywords.filter(t=>t!==e)))(e)},"×")))),(0,l.createElement)("input",{type:"text",placeholder:"Type and press Enter",value:u,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),w())},onBlur:w}))),(0,l.createElement)("div",{className:"form-row"},(0,l.createElement)("div",{className:"form-field narrow"},(0,l.createElement)("label",{htmlFor:"max-page"},"Max per page"),(0,l.createElement)("input",{id:"max-page",type:"number",min:"0",max:"50",value:i.limits?.max_page||1,onChange:e=>C("limits","max_page",parseInt(e.target.value,10)||1)})),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",null,"Options"),(0,l.createElement)("div",{className:"checkbox-group"},(0,l.createElement)("label",{className:"checkbox-item"},(0,l.createElement)("input",{type:"checkbox",checked:i.attributes?.nofollow,onChange:e=>C("attributes","nofollow",e.target.checked)}),(0,l.createElement)("span",null,"nofollow")),(0,l.createElement)("label",{className:"checkbox-item"},(0,l.createElement)("input",{type:"checkbox",checked:i.attributes?.new_tab,onChange:e=>C("attributes","new_tab",e.target.checked)}),(0,l.createElement)("span",null,"New tab")))))),(0,l.createElement)("div",{className:"modal__footer"},(0,l.createElement)("button",{type:"button",className:"button ghost",onClick:c},"Cancel"),(0,l.createElement)("button",{type:"submit",className:"button primary",disabled:b},b?"Saving...":o?"Update":"Create")))))},h=({category:e,templates:t,onClose:a,onSave:c})=>{const r=!!e,[o,i]=(0,n.useState)(()=>e?{...e}:{name:"",color:"#4F46E5",description:"",default_utm:"",category_cap:0}),[m,u]=(0,n.useState)(!1),[d,p]=(0,n.useState)("");return(0,l.createElement)("div",{className:"modal-overlay",onClick:a},(0,l.createElement)("div",{className:"modal",onClick:e=>e.stopPropagation()},(0,l.createElement)("div",{className:"modal__header"},(0,l.createElement)("h2",null,r?"Edit Category":"Add Category"),(0,l.createElement)("button",{type:"button",className:"modal__close",onClick:a},"×")),(0,l.createElement)("form",{onSubmit:async t=>{t.preventDefault(),p(""),u(!0);try{const t=r?`/wpseopilot/v2/internal-links/categories/${e.id}`:"/wpseopilot/v2/internal-links/categories",a=r?"PUT":"POST",l=await s()({path:t,method:a,data:o});l.success?c(l.data):p(l.message||"Failed to save category")}catch(e){p(e.message||"Failed to save category")}finally{u(!1)}}},(0,l.createElement)("div",{className:"modal__body"},d&&(0,l.createElement)("div",{className:"form-error"},d),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",{htmlFor:"cat-name"},"Name"),(0,l.createElement)("input",{id:"cat-name",type:"text",value:o.name,onChange:e=>i({...o,name:e.target.value}),required:!0})),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",{htmlFor:"cat-color"},"Color"),(0,l.createElement)("input",{id:"cat-color",type:"color",value:o.color,onChange:e=>i({...o,color:e.target.value})})),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",{htmlFor:"cat-desc"},"Description"),(0,l.createElement)("textarea",{id:"cat-desc",rows:"3",value:o.description,onChange:e=>i({...o,description:e.target.value})})),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",{htmlFor:"cat-utm"},"Default UTM Template"),(0,l.createElement)("select",{id:"cat-utm",value:o.default_utm,onChange:e=>i({...o,default_utm:e.target.value})},(0,l.createElement)("option",{value:""},"None"),t.map(e=>(0,l.createElement)("option",{key:e.id,value:e.id},e.name)))),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",{htmlFor:"cat-cap"},"Category-level cap (per page)"),(0,l.createElement)("input",{id:"cat-cap",type:"number",min:"0",max:"50",value:o.category_cap||"",onChange:e=>i({...o,category_cap:parseInt(e.target.value,10)||0}),placeholder:"0 = no extra cap"}))),(0,l.createElement)("div",{className:"modal__footer"},(0,l.createElement)("button",{type:"button",className:"button ghost",onClick:a},"Cancel"),(0,l.createElement)("button",{type:"submit",className:"button primary",disabled:m},m?"Saving...":r?"Update Category":"Create Category")))))},v=({template:e,onClose:t,onSave:a})=>{const c=!!e,[r,o]=(0,n.useState)(()=>e?{...e}:{name:"",utm_source:"",utm_medium:"",utm_campaign:"",apply_to:"both"}),[i,m]=(0,n.useState)(!1),[u,d]=(0,n.useState)("");return(0,l.createElement)("div",{className:"modal-overlay",onClick:t},(0,l.createElement)("div",{className:"modal",onClick:e=>e.stopPropagation()},(0,l.createElement)("div",{className:"modal__header"},(0,l.createElement)("h2",null,c?"Edit Template":"Add Template"),(0,l.createElement)("button",{type:"button",className:"modal__close",onClick:t},"×")),(0,l.createElement)("form",{onSubmit:async t=>{t.preventDefault(),d(""),m(!0);try{const t=c?`/wpseopilot/v2/internal-links/templates/${e.id}`:"/wpseopilot/v2/internal-links/templates",l=await s()({path:t,method:c?"PUT":"POST",data:r});l.success?a(l.data):d(l.message||"Failed to save template")}catch(e){d(e.message||"Failed to save template")}finally{m(!1)}}},(0,l.createElement)("div",{className:"modal__body"},u&&(0,l.createElement)("div",{className:"form-error"},u),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",{htmlFor:"tpl-name"},"Name"),(0,l.createElement)("input",{id:"tpl-name",type:"text",value:r.name,onChange:e=>o({...r,name:e.target.value}),required:!0})),(0,l.createElement)("div",{className:"form-row"},(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",{htmlFor:"tpl-source"},"utm_source"),(0,l.createElement)("input",{id:"tpl-source",type:"text",value:r.utm_source||"",onChange:e=>o({...r,utm_source:e.target.value}),placeholder:"e.g., website"})),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",{htmlFor:"tpl-medium"},"utm_medium"),(0,l.createElement)("input",{id:"tpl-medium",type:"text",value:r.utm_medium||"",onChange:e=>o({...r,utm_medium:e.target.value}),placeholder:"e.g., internal_link"}))),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",{htmlFor:"tpl-campaign"},"utm_campaign"),(0,l.createElement)("input",{id:"tpl-campaign",type:"text",value:r.utm_campaign||"",onChange:e=>o({...r,utm_campaign:e.target.value}),placeholder:"e.g., cross_selling"})),(0,l.createElement)("div",{className:"form-field"},(0,l.createElement)("label",null,"Apply to"),(0,l.createElement)("div",{className:"radio-group"},(0,l.createElement)("label",{className:"radio-item"},(0,l.createElement)("input",{type:"radio",name:"apply_to",checked:"internal"===r.apply_to,onChange:()=>o({...r,apply_to:"internal"})}),(0,l.createElement)("span",null,"Internal")),(0,l.createElement)("label",{className:"radio-item"},(0,l.createElement)("input",{type:"radio",name:"apply_to",checked:"external"===r.apply_to,onChange:()=>o({...r,apply_to:"external"})}),(0,l.createElement)("span",null,"External")),(0,l.createElement)("label",{className:"radio-item"},(0,l.createElement)("input",{type:"radio",name:"apply_to",checked:"both"===r.apply_to,onChange:()=>o({...r,apply_to:"both"})}),(0,l.createElement)("span",null,"Both"))))),(0,l.createElement)("div",{className:"modal__footer"},(0,l.createElement)("button",{type:"button",className:"button ghost",onClick:t},"Cancel"),(0,l.createElement)("button",{type:"submit",className:"button primary",disabled:i},i?"Saving...":c?"Update":"Create")))))},y=()=>{const[e,t]=(0,o.A)({tabs:i,defaultTab:"rules"}),[a,c]=(0,n.useState)([]),[m,y]=(0,n.useState)(!0),[b,N]=(0,n.useState)([]),[k,_]=(0,n.useState)([]),[f,C]=(0,n.useState)({}),[w,S]=(0,n.useState)({total_rules:0,active_rules:0,categories:0,utm_templates:0}),[x,A]=(0,n.useState)(""),[T,F]=(0,n.useState)(""),[D,R]=(0,n.useState)(""),[P,L]=(0,n.useState)([]),[U,B]=(0,n.useState)(""),[I,M]=(0,n.useState)(""),[$,O]=(0,n.useState)(!1),[z,q]=(0,n.useState)(null),[K,j]=(0,n.useState)(!1),[G,W]=(0,n.useState)(null),[H,J]=(0,n.useState)(!1),[Q,V]=(0,n.useState)(null),X=(0,n.useCallback)(async()=>{y(!0);try{const[e,t,a,l,n]=await Promise.all([s()({path:"/wpseopilot/v2/internal-links/rules"}),s()({path:"/wpseopilot/v2/internal-links/categories"}),s()({path:"/wpseopilot/v2/internal-links/templates"}),s()({path:"/wpseopilot/v2/internal-links/settings"}),s()({path:"/wpseopilot/v2/internal-links/stats"})]);e.success&&c(e.data),t.success&&N(t.data),a.success&&_(a.data),l.success&&C(l.data),n.success&&S(n.data)}catch(e){console.error("Failed to fetch internal linking data:",e)}finally{y(!1)}},[]);(0,n.useEffect)(()=>{X()},[X]);const Y=a.filter(e=>{if(x&&e.status!==x)return!1;if(T&&e.category!==T)return!1;if(D){const t=D.toLowerCase(),a=(e.title||"").toLowerCase().includes(t),l=(e.keywords||[]).some(e=>e.toLowerCase().includes(t));if(!a&&!l)return!1}return!0}),Z=e=>b.find(t=>t.id===e);return(0,l.createElement)("div",{className:"page"},(0,l.createElement)("div",{className:"page-header"},(0,l.createElement)("div",null,(0,l.createElement)("h1",null,"Internal Linking"),(0,l.createElement)("p",null,"Automatically add internal links to your content based on keywords.")),(0,l.createElement)("div",{className:"page-header__stats"},(0,l.createElement)("div",{className:"stat-chip"},(0,l.createElement)("span",{className:"stat-chip__value"},w.active_rules),(0,l.createElement)("span",{className:"stat-chip__label"},"Active Rules")),(0,l.createElement)("div",{className:"stat-chip"},(0,l.createElement)("span",{className:"stat-chip__value"},w.categories),(0,l.createElement)("span",{className:"stat-chip__label"},"Categories")))),(0,l.createElement)(r.A,{tabs:i,activeTab:e,onChange:t,ariaLabel:"Internal linking sections"}),"rules"===e&&(0,l.createElement)(u,{rules:Y,rulesLoading:m,categories:b,templates:k,selectedRules:P,filterStatus:x,filterCategory:T,filterSearch:D,bulkAction:U,bulkCategory:I,onFilterStatus:A,onFilterCategory:F,onFilterSearch:R,onSelectAll:e=>{e.target.checked?L(Y.map(e=>e.id)):L([])},onSelectRule:e=>{P.includes(e)?L(P.filter(t=>t!==e)):L([...P,e])},onEditRule:e=>{q(e),O(!0)},onDeleteRule:async e=>{if(window.confirm("Are you sure you want to delete this rule?"))try{await s()({path:`/wpseopilot/v2/internal-links/rules/${e}`,method:"DELETE"}),c(a.filter(t=>t.id!==e)),L(P.filter(t=>t!==e))}catch(e){console.error("Failed to delete rule:",e)}},onToggleRule:async e=>{try{const t=await s()({path:`/wpseopilot/v2/internal-links/rules/${e}/toggle`,method:"POST"});t.success&&c(a.map(a=>a.id===e?t.data:a))}catch(e){console.error("Failed to toggle rule:",e)}},onDuplicateRule:async e=>{try{const t=await s()({path:`/wpseopilot/v2/internal-links/rules/${e}/duplicate`,method:"POST"});t.success&&c([t.data,...a])}catch(e){console.error("Failed to duplicate rule:",e)}},onBulkAction:B,onBulkCategory:M,onApplyBulk:async()=>{if(U&&0!==P.length)try{const e={ids:P,action:U};"change_category"===U&&(e.category=I),await s()({path:"/wpseopilot/v2/internal-links/rules/bulk",method:"POST",data:e}),L([]),B(""),M(""),X()}catch(e){console.error("Failed to perform bulk action:",e)}},onAddRule:()=>{q(null),O(!0)},getCategoryById:Z,getTemplateById:e=>k.find(t=>t.id===e)}),"categories"===e&&(0,l.createElement)(d,{categories:b,templates:k,onEdit:e=>{W(e),j(!0)},onDelete:async e=>{if(!Z(e))return;const t=a.filter(t=>t.category===e).length;let l=null;if(t>0){const e=`This category has ${t} rule(s). Delete anyway and remove category from rules?`;if(!window.confirm(e))return;l="__none__"}else if(!window.confirm("Are you sure you want to delete this category?"))return;try{await s()({path:`/wpseopilot/v2/internal-links/categories/${e}`,method:"DELETE",data:l?{reassign:l}:void 0}),N(b.filter(t=>t.id!==e)),l&&c(a.map(t=>t.category===e?{...t,category:""}:t))}catch(e){console.error("Failed to delete category:",e)}},onAdd:()=>{W(null),j(!0)}}),"utm-templates"===e&&(0,l.createElement)(p,{templates:k,onEdit:e=>{V(e),J(!0)},onDelete:async e=>{if(window.confirm("Are you sure you want to delete this UTM template?"))try{await s()({path:`/wpseopilot/v2/internal-links/templates/${e}`,method:"DELETE"}),_(k.filter(t=>t.id!==e))}catch(e){console.error("Failed to delete template:",e)}},onAdd:()=>{V(null),J(!0)}}),"settings"===e&&(0,l.createElement)(E,{settings:f,onChange:C,onSave:async()=>{try{const e=await s()({path:"/wpseopilot/v2/internal-links/settings",method:"POST",data:f});e.success&&C(e.data)}catch(e){console.error("Failed to save settings:",e)}}}),$&&(0,l.createElement)(g,{rule:z,categories:b,templates:k,onClose:()=>{O(!1),q(null)},onSave:e=>{c(z?a.map(t=>t.id===e.id?e:t):[e,...a]),O(!1),q(null)}}),K&&(0,l.createElement)(h,{category:G,templates:k,onClose:()=>{j(!1),W(null)},onSave:e=>{N(G?b.map(t=>t.id===e.id?e:t):[...b,e]),j(!1),W(null)}}),H&&(0,l.createElement)(v,{template:Q,onClose:()=>{J(!1),V(null)},onSave:e=>{_(Q?k.map(t=>t.id===e.id?e:t):[...k,e]),J(!1),V(null)}}))}}}]);