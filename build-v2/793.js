"use strict";(globalThis.webpackChunkwp_seo_pilot_assets=globalThis.webpackChunkwp_seo_pilot_assets||[]).push([[793],{793(e,t,a){a.r(t),a.d(t,{default:()=>g});var s=a(609),n=a(87),l=a(455),i=a.n(l);const c=(0,n.createContext)(null),r=({children:e,assistantId:t,initialMessage:a=""})=>{const[l,r]=(0,n.useState)(()=>a?[{id:"initial",role:"assistant",content:a,actions:[]}]:[]),[o,m]=(0,n.useState)(!1),[d,u]=(0,n.useState)(null),p=(0,n.useCallback)(async(e,a={})=>{if(!e.trim()||o)return;const s={id:`user-${Date.now()}`,role:"user",content:e.trim()};r(e=>[...e,s]),m(!0),u(null);try{const s=await i()({path:"/wpseopilot/v2/assistants/chat",method:"POST",data:{assistant:t,message:e.trim(),context:a}});if(s.success){const e={id:`assistant-${Date.now()}`,role:"assistant",content:s.data.message,actions:s.data.actions||[],data:s.data.data};r(t=>[...t,e])}else u(s.message||"Failed to get response")}catch(e){u(e.message||"An error occurred")}finally{m(!1)}},[t,o]),E=(0,n.useCallback)(async(e,a={})=>{m(!0),u(null);try{const s=await i()({path:"/wpseopilot/v2/assistants/action",method:"POST",data:{assistant:t,action:e,context:a}});if(s.success){const e={id:`assistant-${Date.now()}`,role:"assistant",content:s.data.message,actions:s.data.actions||[],data:s.data.data};r(t=>[...t,e])}else u(s.message||"Failed to execute action")}catch(e){u(e.message||"An error occurred")}finally{m(!1)}},[t]),h=(0,n.useCallback)(()=>{r(a?[{id:"initial",role:"assistant",content:a,actions:[]}]:[]),u(null)},[a]),g={messages:l,isLoading:o,error:d,sendMessage:p,executeAction:E,clearChat:h,assistantId:t};return(0,s.createElement)(c.Provider,{value:g},e)},o=({message:e,isUser:t,actions:a,onAction:n})=>(0,s.createElement)("div",{className:"assistant-message "+(t?"assistant-message--user":"assistant-message--assistant")},(0,s.createElement)("div",{className:"assistant-message__content"},t?(0,s.createElement)("p",null,e):(0,s.createElement)("div",{className:"assistant-message__text",dangerouslySetInnerHTML:{__html:(e=>{if(!e)return"";const t=e.split("\n"),a=[];let s=!1;return t.forEach((e,n)=>{let l=e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>");l=l.replace(/__(.*?)__/g,"<strong>$1</strong>"),e.match(/^[-*]\s+(.*)$/)?(s||(a.push('<ul class="assistant-message__list">'),s=!0),a.push(`<li>${l.replace(/^[-*]\s+/,"")}</li>`)):(s&&(a.push("</ul>"),s=!1),l.trim()?a.push(`<p>${l}</p>`):n<t.length-1&&a.push("<br/>"))}),s&&a.push("</ul>"),a.join("")})(e)}})),!t&&a&&a.length>0&&(0,s.createElement)("div",{className:"assistant-message__actions"},a.map(e=>(0,s.createElement)("button",{key:e.id,type:"button",className:"assistant-message__action-btn",onClick:()=>n&&n(e.id)},e.label)))),m=()=>(0,s.createElement)("div",{className:"assistant-typing"},(0,s.createElement)("div",{className:"assistant-typing__dot"}),(0,s.createElement)("div",{className:"assistant-typing__dot"}),(0,s.createElement)("div",{className:"assistant-typing__dot"})),d=({suggestedPrompts:e=[]})=>{const{messages:t,isLoading:a,error:l,sendMessage:i,executeAction:r}=(()=>{const e=(0,n.useContext)(c);if(!e)throw new Error("useAssistant must be used within an AssistantProvider");return e})(),[d,u]=(0,n.useState)(""),p=(0,n.useRef)(null),E=(0,n.useRef)(null);(0,n.useEffect)(()=>{p.current?.scrollIntoView({behavior:"smooth"})},[t,a]),(0,n.useEffect)(()=>{E.current?.focus()},[]);const h=e=>{e.preventDefault(),d.trim()&&!a&&(i(d),u(""))},g=e=>{a||r(e)},v=t.length<=1&&e.length>0;return(0,s.createElement)("div",{className:"assistant-chat"},(0,s.createElement)("div",{className:"assistant-chat__messages"},t.map(e=>(0,s.createElement)(o,{key:e.id,message:e.content,isUser:"user"===e.role,actions:e.actions,onAction:g})),a&&(0,s.createElement)(m,null),l&&(0,s.createElement)("div",{className:"assistant-chat__error"},(0,s.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,s.createElement)("circle",{cx:"12",cy:"12",r:"10"}),(0,s.createElement)("path",{d:"M12 8v4m0 4h.01"})),(0,s.createElement)("span",null,l)),(0,s.createElement)("div",{ref:p})),v&&(0,s.createElement)("div",{className:"assistant-chat__suggestions"},(0,s.createElement)("p",{className:"assistant-chat__suggestions-label"},"Try asking:"),(0,s.createElement)("div",{className:"assistant-chat__suggestions-list"},e.map((e,t)=>(0,s.createElement)("button",{key:t,type:"button",className:"assistant-chat__suggestion",onClick:()=>(e=>{a||i(e)})(e),disabled:a},e)))),(0,s.createElement)("form",{className:"assistant-chat__input-form",onSubmit:h},(0,s.createElement)("div",{className:"assistant-chat__input-wrapper"},(0,s.createElement)("textarea",{ref:E,className:"assistant-chat__input",value:d,onChange:e=>u(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),h(e))},placeholder:"Type your message...",disabled:a,rows:1}),(0,s.createElement)("button",{type:"submit",className:"assistant-chat__send-btn",disabled:!d.trim()||a},(0,s.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,s.createElement)("path",{d:"M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"}))))))},u=((0,s.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,s.createElement)("circle",{cx:"11",cy:"11",r:"8"}),(0,s.createElement)("path",{d:"M21 21l-4.35-4.35"}),(0,s.createElement)("path",{d:"M11 8v6M8 11h6"})),(0,s.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,s.createElement)("path",{d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2"}),(0,s.createElement)("rect",{x:"9",y:"3",width:"6",height:"4",rx:"1"}),(0,s.createElement)("path",{d:"M9 12h6M9 16h6"})),window?.wpseopilotV2Settings||{}),p=u.aiEnabled||!1,E=u.aiProvider||"none",h=u.aiPilot||null,g=({initialAssistant:e=null})=>{const[t,a]=(0,n.useState)("list"),[l,c]=(0,n.useState)([]),[o,m]=(0,n.useState)([]),[u,g]=(0,n.useState)(null),[v,_]=(0,n.useState)(null),[N,b]=(0,n.useState)(null),[y,f]=(0,n.useState)(!0),[k,w]=(0,n.useState)(!1),[C,A]=(0,n.useState)({name:"",description:"",system_prompt:"",initial_message:"",icon:"ðŸ¤–",color:"#6366f1",model_id:"",is_active:!0}),M=(0,n.useCallback)(async()=>{f(!0);try{const[e,t,a]=await Promise.all([i()({path:"/wpseopilot/v2/assistants"}),i()({path:"/wpseopilot/v2/assistants/custom"}),i()({path:"/wpseopilot/v2/assistants/stats"})]);e.success&&c(e.data),t.success&&m(t.data),a.success&&g(a.data)}catch(e){console.error("Failed to fetch assistants:",e)}finally{f(!1)}},[]);(0,n.useEffect)(()=>{M()},[M]),(0,n.useEffect)(()=>{if(e&&l.length>0){const t=l.find(t=>t.id===e);t&&(_(t),a("chat"))}},[e,l]);const x=e=>{_(e),a("chat")},P=()=>{_(null),b(null),a("list"),A({name:"",description:"",system_prompt:"",initial_message:"",icon:"ðŸ¤–",color:"#6366f1",model_id:"",is_active:!0})},I=()=>{A({name:"",description:"",system_prompt:"",initial_message:"",icon:"ðŸ¤–",color:"#6366f1",model_id:"",is_active:!0}),b(null),a("create")},S=(e,t)=>{A(a=>({...a,[e]:t}))};return y?(0,s.createElement)("div",{className:"page"},(0,s.createElement)("div",{className:"loading-state"},"Loading assistants...")):"chat"===t&&v?(0,s.createElement)("div",{className:"page assistants-page"},(0,s.createElement)("div",{className:"page-header page-header--with-back"},(0,s.createElement)("button",{type:"button",className:"back-button",onClick:P},(0,s.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,s.createElement)("path",{d:"M15 18l-6-6 6-6"})),(0,s.createElement)("span",null,"All Assistants")),(0,s.createElement)("div",{className:"page-header__info"},(0,s.createElement)("div",{className:"page-header__icon",style:{backgroundColor:`${v.color}15`,color:v.color}},v.icon),(0,s.createElement)("div",null,(0,s.createElement)("h1",null,v.name),(0,s.createElement)("p",null,v.description)))),(0,s.createElement)("div",{className:"assistants-chat-container"},(0,s.createElement)(r,{key:v.id,assistantId:v.id,initialMessage:v.initial_message||v.initialMessage},(0,s.createElement)(d,{suggestedPrompts:v.suggested_prompts||v.suggestedPrompts})))):"create"===t||"edit"===t?(0,s.createElement)("div",{className:"page"},(0,s.createElement)("div",{className:"page-header page-header--with-back"},(0,s.createElement)("button",{type:"button",className:"back-button",onClick:P},(0,s.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,s.createElement)("path",{d:"M15 18l-6-6 6-6"})),(0,s.createElement)("span",null,"All Assistants")),(0,s.createElement)("div",null,(0,s.createElement)("h1",null,"edit"===t?"Edit Assistant":"Create Assistant"),(0,s.createElement)("p",null,"Configure your custom AI assistant."))),(0,s.createElement)("div",{className:"assistants-form"},(0,s.createElement)("div",{className:"panel"},(0,s.createElement)("h3",null,"Basic Info"),(0,s.createElement)("div",{className:"form-row"},(0,s.createElement)("label",{htmlFor:"name"},"Name *"),(0,s.createElement)("input",{id:"name",type:"text",value:C.name,onChange:e=>S("name",e.target.value),placeholder:"My SEO Assistant"})),(0,s.createElement)("div",{className:"form-row"},(0,s.createElement)("label",{htmlFor:"description"},"Description"),(0,s.createElement)("input",{id:"description",type:"text",value:C.description,onChange:e=>S("description",e.target.value),placeholder:"A helpful assistant for..."})),(0,s.createElement)("div",{className:"form-row"},(0,s.createElement)("label",null,"Icon"),(0,s.createElement)("div",{className:"icon-picker"},["ðŸ¤–","ðŸ’¬","ðŸ“Š","ðŸŽ¯","âœ¨","ðŸ”","ðŸ“","ðŸ’¡","ðŸš€","âš¡"].map(e=>(0,s.createElement)("button",{key:e,type:"button",className:"icon-option "+(C.icon===e?"active":""),onClick:()=>S("icon",e)},e)))),(0,s.createElement)("div",{className:"form-row"},(0,s.createElement)("label",null,"Color"),(0,s.createElement)("div",{className:"color-picker"},["#3b82f6","#8b5cf6","#6366f1","#ec4899","#f59e0b","#10b981","#ef4444","#6b7280"].map(e=>(0,s.createElement)("button",{key:e,type:"button",className:"color-option "+(C.color===e?"active":""),style:{backgroundColor:e},onClick:()=>S("color",e)}))))),(0,s.createElement)("div",{className:"panel"},(0,s.createElement)("h3",null,"AI Configuration"),(0,s.createElement)("div",{className:"form-row"},(0,s.createElement)("label",{htmlFor:"system_prompt"},"System Prompt *"),(0,s.createElement)("textarea",{id:"system_prompt",value:C.system_prompt,onChange:e=>S("system_prompt",e.target.value),placeholder:"You are a helpful SEO assistant...",rows:6}),(0,s.createElement)("p",{className:"form-help"},"Define the assistant's personality and expertise.")),(0,s.createElement)("div",{className:"form-row"},(0,s.createElement)("label",{htmlFor:"initial_message"},"Welcome Message"),(0,s.createElement)("textarea",{id:"initial_message",value:C.initial_message,onChange:e=>S("initial_message",e.target.value),placeholder:"Hi! I'm here to help with...",rows:2})),(0,s.createElement)("div",{className:"form-row"},(0,s.createElement)("label",{htmlFor:"model_id"},"Model (optional)"),(0,s.createElement)("input",{id:"model_id",type:"text",value:C.model_id,onChange:e=>S("model_id",e.target.value),placeholder:"Leave empty to use default model"}),(0,s.createElement)("p",{className:"form-help"},"Use custom_ID for custom models (e.g., custom_1).")),(0,s.createElement)("div",{className:"form-row form-row--checkbox"},(0,s.createElement)("label",null,(0,s.createElement)("input",{type:"checkbox",checked:C.is_active,onChange:e=>S("is_active",e.target.checked)}),(0,s.createElement)("span",null,"Active")))),(0,s.createElement)("div",{className:"form-actions"},(0,s.createElement)("button",{type:"button",className:"button ghost",onClick:P},"Cancel"),(0,s.createElement)("button",{type:"button",className:"button primary",onClick:async()=>{if(C.name&&C.system_prompt){w(!0);try{N?await i()({path:`/wpseopilot/v2/assistants/custom/${N.id}`,method:"PUT",data:C}):await i()({path:"/wpseopilot/v2/assistants/custom",method:"POST",data:C}),await M(),P()}catch(e){console.error("Failed to save assistant:",e),alert("Failed to save assistant.")}finally{w(!1)}}else alert("Name and system prompt are required.")},disabled:k},k?"Saving...":"edit"===t?"Save Changes":"Create Assistant")))):(0,s.createElement)("div",{className:"page"},(0,s.createElement)("div",{className:"page-header"},(0,s.createElement)("div",null,(0,s.createElement)("h1",null,"AI Assistants"),(0,s.createElement)("p",null,"Manage your AI assistants and track usage.")),(0,s.createElement)("div",{className:"page-header__actions"},"wp-ai-pilot"===E&&(0,s.createElement)("a",{href:h?.settingsUrl||"admin.php?page=wp-ai-pilot",className:"button ghost"},(0,s.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,s.createElement)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"})),"WP AI Pilot"),(0,s.createElement)("button",{type:"button",className:"button primary",onClick:I},"+ Create Assistant"))),!p&&(0,s.createElement)("div",{className:"assistants-notice"},(0,s.createElement)("div",{className:"assistants-notice__icon"},(0,s.createElement)("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,s.createElement)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"}))),(0,s.createElement)("div",{className:"assistants-notice__content"},(0,s.createElement)("h3",null,"AI Assistants Powered by WP AI Pilot"),h?.installed?(0,s.createElement)(s.Fragment,null,(0,s.createElement)("p",null,"WP AI Pilot is installed but needs configuration. Add an API key to enable AI assistants."),(0,s.createElement)("a",{href:h.settingsUrl||"admin.php?page=wp-ai-pilot",className:"button primary"},"Configure WP AI Pilot")):(0,s.createElement)(s.Fragment,null,(0,s.createElement)("p",null,"Install WP AI Pilot to access AI-powered assistants for SEO optimization, content generation, and more."),(0,s.createElement)("a",{href:"plugin-install.php?s=wp+ai+pilot&tab=search",className:"button primary"},"Install WP AI Pilot")))),u&&(0,s.createElement)("div",{className:"stats-grid"},(0,s.createElement)("div",{className:"stat-card"},(0,s.createElement)("div",{className:"stat-card__value"},u.total_messages),(0,s.createElement)("div",{className:"stat-card__label"},"Total Messages")),(0,s.createElement)("div",{className:"stat-card"},(0,s.createElement)("div",{className:"stat-card__value"},u.today),(0,s.createElement)("div",{className:"stat-card__label"},"Today")),(0,s.createElement)("div",{className:"stat-card"},(0,s.createElement)("div",{className:"stat-card__value"},u.this_week),(0,s.createElement)("div",{className:"stat-card__label"},"This Week")),(0,s.createElement)("div",{className:"stat-card"},(0,s.createElement)("div",{className:"stat-card__value"},u.this_month),(0,s.createElement)("div",{className:"stat-card__label"},"This Month"))),(0,s.createElement)("div",{className:"assistants-section"},(0,s.createElement)("h2",null,"Built-in Assistants"),(0,s.createElement)("div",{className:"assistants-grid"},l.filter(e=>e.is_builtin).map(e=>(0,s.createElement)("button",{key:e.id,type:"button",className:"assistant-card",onClick:()=>x(e)},(0,s.createElement)("div",{className:"assistant-card__icon",style:{backgroundColor:`${e.color}15`,color:e.color}},e.icon),(0,s.createElement)("div",{className:"assistant-card__content"},(0,s.createElement)("h3",{className:"assistant-card__name"},e.name),(0,s.createElement)("p",{className:"assistant-card__desc"},e.description)),(0,s.createElement)("div",{className:"assistant-card__arrow",style:{color:e.color}},(0,s.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,s.createElement)("path",{d:"M9 18l6-6-6-6"}))))))),(0,s.createElement)("div",{className:"assistants-section"},(0,s.createElement)("h2",null,"Custom Assistants"),0===o.length?(0,s.createElement)("div",{className:"empty-state"},(0,s.createElement)("p",null,"No custom assistants yet."),(0,s.createElement)("button",{type:"button",className:"button",onClick:I},"Create your first assistant")):(0,s.createElement)("div",{className:"assistants-grid"},o.map(e=>(0,s.createElement)("div",{key:e.id,className:"assistant-card assistant-card--custom"},(0,s.createElement)("button",{type:"button",className:"assistant-card__main",onClick:()=>x({...e,id:`custom_${e.id}`})},(0,s.createElement)("div",{className:"assistant-card__icon",style:{backgroundColor:`${e.color||"#6366f1"}15`,color:e.color||"#6366f1"}},e.icon||"ðŸ¤–"),(0,s.createElement)("div",{className:"assistant-card__content"},(0,s.createElement)("h3",{className:"assistant-card__name"},e.name,!e.is_active&&(0,s.createElement)("span",{className:"badge badge--muted"},"Inactive")),(0,s.createElement)("p",{className:"assistant-card__desc"},e.description||"Custom assistant"),e.usage>0&&(0,s.createElement)("span",{className:"assistant-card__usage"},e.usage," messages"))),(0,s.createElement)("div",{className:"assistant-card__actions"},(0,s.createElement)("button",{type:"button",className:"icon-button",onClick:()=>(e=>{A({name:e.name||"",description:e.description||"",system_prompt:e.system_prompt||"",initial_message:e.initial_message||"",icon:e.icon||"ðŸ¤–",color:e.color||"#6366f1",model_id:e.model_id||"",is_active:!1!==e.is_active}),b(e),a("edit")})(e),title:"Edit"},(0,s.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,s.createElement)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,s.createElement)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}))),(0,s.createElement)("button",{type:"button",className:"icon-button icon-button--danger",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this assistant?"))try{await i()({path:`/wpseopilot/v2/assistants/custom/${e}`,method:"DELETE"}),await M()}catch(e){console.error("Failed to delete assistant:",e)}})(e.id),title:"Delete"},(0,s.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,s.createElement)("path",{d:"M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})))))))))}}}]);