"use strict";(globalThis.webpackChunksaman_labs_seo=globalThis.webpackChunksaman_labs_seo||[]).push([[19],{19(e,t,a){a.r(t),a.d(t,{default:()=>u});var l=a(609),n=a(87),s=a(455),c=a.n(s);const r=[{value:301,label:"301 - Permanent Redirect"},{value:302,label:"302 - Temporary Redirect"},{value:307,label:"307 - Temporary (Preserve Method)"},{value:410,label:"410 - Gone (Deleted)"}],o=({entry:e,onClose:t,onSuccess:a})=>{const[s,o]=(0,n.useState)([]),[m,i]=(0,n.useState)(!0),[d,u]=(0,n.useState)(!1),[E,g]=(0,n.useState)(""),[p,b]=(0,n.useState)(""),[h,v]=(0,n.useState)(301),[N,y]=(0,n.useState)(!0),[f,k]=(0,n.useState)("");return(0,n.useEffect)(()=>{(async()=>{i(!0);try{const t=await c()({path:`/samanlabs-seo/v1/404-log/${e.id}/suggestions`});t.success&&t.data.suggestions&&(o(t.data.suggestions),t.data.suggestions.length>0&&g(t.data.suggestions[0].url))}catch(e){console.error("Failed to fetch suggestions:",e)}finally{i(!1)}})()},[e.id]),(0,l.createElement)("div",{className:"modal-overlay",onClick:e=>e.target===e.currentTarget&&t()},(0,l.createElement)("div",{className:"modal redirect-modal"},(0,l.createElement)("div",{className:"modal__header"},(0,l.createElement)("h2",null,"Create Redirect"),(0,l.createElement)("button",{type:"button",className:"modal__close",onClick:t},(0,l.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",width:"20",height:"20"},(0,l.createElement)("path",{d:"M18 6L6 18M6 6l12 12"})))),(0,l.createElement)("div",{className:"modal__body"},(0,l.createElement)("div",{className:"form-group"},(0,l.createElement)("label",null,"Source URL (404)"),(0,l.createElement)("div",{className:"source-url"},(0,l.createElement)("code",null,e.request_uri),(0,l.createElement)("span",{className:"hits-badge"},e.hits," hits"))),(0,l.createElement)("div",{className:"form-group"},(0,l.createElement)("label",null,"Target URL"),m?(0,l.createElement)("div",{className:"suggestions-loading"},"Loading suggestions..."):(0,l.createElement)(l.Fragment,null,s.length>0&&(0,l.createElement)("div",{className:"suggestions-list"},(0,l.createElement)("p",{className:"suggestions-label"},"Suggested targets:"),s.map((e,t)=>(0,l.createElement)("label",{key:t,className:"suggestion-item"},(0,l.createElement)("input",{type:"radio",name:"target",value:e.url,checked:E===e.url,onChange:()=>g(e.url)}),(0,l.createElement)("div",{className:"suggestion-content"},(0,l.createElement)("span",{className:"suggestion-title"},e.title),(0,l.createElement)("span",{className:"suggestion-url"},e.url),(0,l.createElement)("span",{className:"suggestion-score"},e.score,"% match"))))),(0,l.createElement)("div",{className:"custom-url-option"},(0,l.createElement)("label",{className:"suggestion-item"},(0,l.createElement)("input",{type:"radio",name:"target",value:"custom",checked:"custom"===E,onChange:()=>g("custom")}),(0,l.createElement)("span",null,"Enter custom URL")),"custom"===E&&(0,l.createElement)("input",{type:"url",className:"custom-url-input",placeholder:"https://example.com/page",value:p,onChange:e=>b(e.target.value),autoFocus:!0})))),(0,l.createElement)("div",{className:"form-group"},(0,l.createElement)("label",{htmlFor:"status-code"},"Status Code"),(0,l.createElement)("select",{id:"status-code",value:h,onChange:e=>v(parseInt(e.target.value,10))},r.map(e=>(0,l.createElement)("option",{key:e.value,value:e.value},e.label)))),(0,l.createElement)("div",{className:"form-group"},(0,l.createElement)("label",{className:"checkbox-label"},(0,l.createElement)("input",{type:"checkbox",checked:N,onChange:e=>y(e.target.checked)}),(0,l.createElement)("span",null,"Remove 404 entry after creating redirect"))),f&&(0,l.createElement)("div",{className:"form-error"},f)),(0,l.createElement)("div",{className:"modal__footer"},(0,l.createElement)("button",{type:"button",className:"button",onClick:t,disabled:d},"Cancel"),(0,l.createElement)("button",{type:"button",className:"button primary",onClick:async()=>{const t="custom"===E?p:E;if(t){u(!0),k("");try{const l=await c()({path:`/samanlabs-seo/v1/404-log/${e.id}/create-redirect`,method:"POST",data:{target:t,status_code:h,delete_entry:N}});l.success?a(l.data):k(l.message||"Failed to create redirect.")}catch(e){k(e.message||"Failed to create redirect.")}finally{u(!1)}}else k("Please select or enter a target URL.")},disabled:d||m||!E||"custom"===E&&!p},d?"Creating...":"Create Redirect"))))},m=({onClose:e,onPatternChange:t})=>{const[a,s]=(0,n.useState)([]),[r,o]=(0,n.useState)(!0),[m,i]=(0,n.useState)(""),[d,u]=(0,n.useState)(!1),[E,g]=(0,n.useState)(""),[p,b]=(0,n.useState)(!1),[h,v]=(0,n.useState)(null),[N,y]=(0,n.useState)("");(0,n.useEffect)(()=>{f()},[]);const f=async()=>{o(!0);try{const e=await c()({path:"/samanlabs-seo/v1/404-ignore-patterns"});e.success&&s(e.data)}catch(e){console.error("Failed to fetch patterns:",e)}finally{o(!1)}};return(0,l.createElement)("div",{className:"modal-overlay",onClick:e},(0,l.createElement)("div",{className:"modal ignore-pattern-modal",onClick:e=>e.stopPropagation()},(0,l.createElement)("div",{className:"modal-header"},(0,l.createElement)("h2",null,"Manage Ignore Patterns"),(0,l.createElement)("button",{type:"button",className:"modal-close",onClick:e},(0,l.createElement)("svg",{viewBox:"0 0 20 20",fill:"currentColor",width:"20",height:"20"},(0,l.createElement)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})))),(0,l.createElement)("div",{className:"modal-body"},(0,l.createElement)("p",{className:"modal-description"},"Add URL patterns to automatically ignore matching 404 errors. Use ",(0,l.createElement)("code",null,"*")," as wildcard (e.g., ",(0,l.createElement)("code",null,"/uploads/*"),") or enable regex for complex patterns."),(0,l.createElement)("form",{onSubmit:async e=>{if(e.preventDefault(),m.trim()){b(!0),y("");try{const e=await c()({path:"/samanlabs-seo/v1/404-ignore-patterns",method:"POST",data:{pattern:m.trim(),is_regex:d,reason:E.trim()}});e.success?(s(t=>[...t,e.data]),i(""),u(!1),g(""),t?.()):y(e.message||"Failed to add pattern")}catch(e){y(e.message||"Failed to add pattern")}finally{b(!1)}}},className:"pattern-form"},(0,l.createElement)("div",{className:"form-row"},(0,l.createElement)("label",{className:"form-field"},(0,l.createElement)("span",null,"Pattern"),(0,l.createElement)("input",{type:"text",value:m,onChange:e=>i(e.target.value),placeholder:d?"^/old-.*\\.html$":"/uploads/*",disabled:p}))),(0,l.createElement)("div",{className:"form-row form-row--split"},(0,l.createElement)("label",{className:"form-field"},(0,l.createElement)("span",null,"Reason (optional)"),(0,l.createElement)("input",{type:"text",value:E,onChange:e=>g(e.target.value),placeholder:"e.g., Legacy URLs",disabled:p})),(0,l.createElement)("label",{className:"form-checkbox"},(0,l.createElement)("input",{type:"checkbox",checked:d,onChange:e=>u(e.target.checked),disabled:p}),(0,l.createElement)("span",null,"Use Regex"))),N&&(0,l.createElement)("p",{className:"form-error"},N),(0,l.createElement)("div",{className:"form-actions"},(0,l.createElement)("button",{type:"submit",className:"button primary",disabled:p||!m.trim()},p?"Adding...":"Add Pattern"))),(0,l.createElement)("div",{className:"patterns-list"},(0,l.createElement)("h3",null,"Current Patterns"),r?(0,l.createElement)("div",{className:"loading-state"},"Loading patterns..."):0===a.length?(0,l.createElement)("div",{className:"empty-state small"},(0,l.createElement)("p",null,"No ignore patterns defined yet.")):(0,l.createElement)("table",{className:"data-table compact"},(0,l.createElement)("thead",null,(0,l.createElement)("tr",null,(0,l.createElement)("th",null,"Pattern"),(0,l.createElement)("th",null,"Type"),(0,l.createElement)("th",null,"Reason"),(0,l.createElement)("th",null,"Created"),(0,l.createElement)("th",null,"Action"))),(0,l.createElement)("tbody",null,a.map(e=>{return(0,l.createElement)("tr",{key:e.id},(0,l.createElement)("td",null,(0,l.createElement)("code",null,e.pattern)),(0,l.createElement)("td",null,(0,l.createElement)("span",{className:"badge "+(e.is_regex?"info":"muted")},e.is_regex?"Regex":"Wildcard")),(0,l.createElement)("td",null,e.reason||"-"),(0,l.createElement)("td",null,(a=e.created_at)&&"0000-00-00 00:00:00"!==a?new Date(a).toLocaleDateString():"-"),(0,l.createElement)("td",null,(0,l.createElement)("button",{type:"button",className:"button ghost small danger",onClick:()=>(async e=>{v(e);try{await c()({path:`/samanlabs-seo/v1/404-ignore-patterns/${e}`,method:"DELETE"}),s(t=>t.filter(t=>t.id!==e)),t?.()}catch(e){console.error("Failed to delete pattern:",e)}finally{v(null)}})(e.id),disabled:h===e.id},h===e.id?"...":"Delete")));var a}))))),(0,l.createElement)("div",{className:"modal-footer"},(0,l.createElement)("button",{type:"button",className:"button",onClick:e},"Close"))))},i=[{value:"recent",label:"Most recent"},{value:"top",label:"Top hits"}],d=[25,50,100,200],u=({onNavigate:e})=>{const[t,a]=(0,n.useState)([]),[s,r]=(0,n.useState)(!0),[u,E]=(0,n.useState)(0),[g,p]=(0,n.useState)(0),[b,h]=(0,n.useState)(1),[v,N]=(0,n.useState)(50),[y,f]=(0,n.useState)(1),[k,_]=(0,n.useState)("recent"),[C,x]=(0,n.useState)(!0),[S,w]=(0,n.useState)(!1),[L,R]=(0,n.useState)(!1),[P,T]=(0,n.useState)(!1),[U,F]=(0,n.useState)(null),[M,D]=(0,n.useState)(!1),[$,B]=(0,n.useState)(!1),[I,A]=(0,n.useState)(!1),[O,q]=(0,n.useState)(!1),[H,j]=(0,n.useState)(0),[W,z]=(0,n.useState)(null),G=(0,n.useCallback)(async()=>{r(!0);try{const e=new URLSearchParams({sort:k,per_page:v,page:b,hide_spam:C?"1":"0",hide_images:S?"1":"0",hide_bots:L?"1":"0",hide_ignored:O?"0":"1"}),t=await c()({path:`/samanlabs-seo/v1/404-log?${e}`});t.success&&(a(t.data.items),E(t.data.total),f(t.data.total_pages),p(t.data.bot_count||0),j(t.data.ignored_count||0))}catch(e){console.error("Failed to fetch 404 log:",e)}finally{r(!1)}},[k,v,b,C,S,L,O]);(0,n.useEffect)(()=>{G()},[G]);const J=async e=>{D(!0),B(!1);try{const t=new URLSearchParams({format:e,hide_spam:C?"1":"0",hide_images:S?"1":"0",hide_bots:L?"1":"0"}),a=await c()({path:`/samanlabs-seo/v1/404-log/export?${t}`});if(a.success&&a.data.content){const t=new Blob([a.data.content],{type:"csv"===e?"text/csv":"application/json"}),l=URL.createObjectURL(t),n=document.createElement("a");n.href=l,n.download=a.data.filename,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(l)}}catch(e){console.error("Failed to export:",e)}finally{D(!1)}};return(0,l.createElement)("div",{className:"page"},(0,l.createElement)("div",{className:"page-header"},(0,l.createElement)("div",null,(0,l.createElement)("h1",null,"404 Log"),(0,l.createElement)("p",null,"Monitor broken links and create redirects to fix them.")),(0,l.createElement)("div",{className:"header-actions"},(0,l.createElement)("button",{type:"button",className:"button",onClick:()=>A(!0)},"Manage Ignore Patterns"),(0,l.createElement)("div",{className:"dropdown-wrapper"},(0,l.createElement)("button",{type:"button",className:"button",onClick:()=>B(!$),disabled:M||0===t.length},M?"Exporting...":"Export",(0,l.createElement)("svg",{viewBox:"0 0 20 20",fill:"currentColor",width:"16",height:"16",style:{marginLeft:4}},(0,l.createElement)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"}))),$&&(0,l.createElement)("div",{className:"dropdown-menu"},(0,l.createElement)("button",{type:"button",onClick:()=>J("csv")},"Export as CSV"),(0,l.createElement)("button",{type:"button",onClick:()=>J("json")},"Export as JSON"))),(0,l.createElement)("button",{type:"button",className:"button ghost",onClick:async()=>{if(window.confirm("Are you sure you want to clear the entire 404 log? This cannot be undone.")){T(!0);try{await c()({path:"/samanlabs-seo/v1/404-log",method:"DELETE"}),a([]),E(0),f(1),h(1)}catch(e){console.error("Failed to clear log:",e)}finally{T(!1)}}},disabled:P||0===t.length},P?"Clearing...":"Clear Log"))),(0,l.createElement)("section",{className:"panel"},(0,l.createElement)("div",{className:"table-toolbar"},(0,l.createElement)("div",{className:"stats-bar"},(0,l.createElement)("div",{className:"stat-box"},(0,l.createElement)("span",{className:"stat-box__value"},u.toLocaleString()),(0,l.createElement)("span",{className:"stat-box__label"},"Total Entries")),(0,l.createElement)("div",{className:"stat-box"},(0,l.createElement)("span",{className:"stat-box__value"},t.filter(e=>!e.redirect_exists).length),(0,l.createElement)("span",{className:"stat-box__label"},"Need Redirect")),(0,l.createElement)("div",{className:"stat-box"},(0,l.createElement)("span",{className:"stat-box__value"},g.toLocaleString()),(0,l.createElement)("span",{className:"stat-box__label"},"Bot Hits")),(0,l.createElement)("div",{className:"stat-box"},(0,l.createElement)("span",{className:"stat-box__value"},H.toLocaleString()),(0,l.createElement)("span",{className:"stat-box__label"},"Ignored")))),(0,l.createElement)("div",{className:"filter-form"},(0,l.createElement)("div",{className:"filter-row"},(0,l.createElement)("label",{className:"filter-field"},(0,l.createElement)("span",null,"Sort by"),(0,l.createElement)("select",{value:k,onChange:e=>{_(e.target.value),h(1)}},i.map(e=>(0,l.createElement)("option",{key:e.value,value:e.value},e.label)))),(0,l.createElement)("label",{className:"filter-field"},(0,l.createElement)("span",null,"Rows per page"),(0,l.createElement)("select",{value:v,onChange:e=>{N(parseInt(e.target.value,10)),h(1)}},d.map(e=>(0,l.createElement)("option",{key:e,value:e},e)))),(0,l.createElement)("label",{className:"filter-checkbox"},(0,l.createElement)("input",{type:"checkbox",checked:C,onChange:e=>{x(e.target.checked),h(1)}}),(0,l.createElement)("span",null,"Hide spammy extensions")),(0,l.createElement)("label",{className:"filter-checkbox"},(0,l.createElement)("input",{type:"checkbox",checked:S,onChange:e=>{w(e.target.checked),h(1)}}),(0,l.createElement)("span",null,"Hide image extensions")),(0,l.createElement)("label",{className:"filter-checkbox"},(0,l.createElement)("input",{type:"checkbox",checked:L,onChange:e=>{R(e.target.checked),h(1)}}),(0,l.createElement)("span",null,"Hide bots/crawlers")),(0,l.createElement)("label",{className:"filter-checkbox"},(0,l.createElement)("input",{type:"checkbox",checked:O,onChange:e=>{q(e.target.checked),h(1)}}),(0,l.createElement)("span",null,"Show ignored")))),s?(0,l.createElement)("div",{className:"loading-state"},"Loading 404 log..."):0===t.length?(0,l.createElement)("div",{className:"empty-state"},(0,l.createElement)("div",{className:"empty-state__icon"},(0,l.createElement)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",width:"48",height:"48"},(0,l.createElement)("circle",{cx:"12",cy:"12",r:"10"}),(0,l.createElement)("path",{d:"M9 9l6 6m0-6l-6 6"}))),(0,l.createElement)("h3",null,"No 404 errors logged"),(0,l.createElement)("p",null,"Great news! Your site doesn't have any broken links recorded yet.")):(0,l.createElement)(l.Fragment,null,(0,l.createElement)("table",{className:"data-table"},(0,l.createElement)("thead",null,(0,l.createElement)("tr",null,(0,l.createElement)("th",null,"Request URL"),(0,l.createElement)("th",null,"Hits"),(0,l.createElement)("th",null,"Last Seen"),(0,l.createElement)("th",null,"Device"),(0,l.createElement)("th",null,"Action"))),(0,l.createElement)("tbody",null,t.map(e=>(0,l.createElement)("tr",{key:e.id,className:`${e.is_bot?"is-bot-row":""} ${e.is_ignored?"is-ignored-row":""}`},(0,l.createElement)("td",{className:"url-cell"},(0,l.createElement)("code",null,e.request_uri),e.redirect_exists&&(0,l.createElement)("span",{className:"badge success"},"Redirect exists"),e.is_bot&&(0,l.createElement)("span",{className:"badge muted",title:"Bot/crawler request"},"Bot"),e.is_ignored&&(0,l.createElement)("span",{className:"badge warning",title:"This URL is ignored"},"Ignored")),(0,l.createElement)("td",null,(0,l.createElement)("span",{className:"hits-badge "+(e.hits>10?"high":e.hits>5?"medium":"")},e.hits)),(0,l.createElement)("td",null,(e=>{if(!e||"0000-00-00 00:00:00"===e)return"-";const t=new Date(e);return t.toLocaleDateString()+", "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})(e.last_seen)),(0,l.createElement)("td",null,e.device_label),(0,l.createElement)("td",{className:"action-cell"},(0,l.createElement)("div",{className:"action-buttons"},!e.redirect_exists&&(0,l.createElement)("button",{type:"button",className:"button primary small",onClick:()=>(e=>{F(e)})(e)},"Redirect"),e.is_ignored?(0,l.createElement)("button",{type:"button",className:"button small",onClick:()=>(async e=>{z(e.id);try{await c()({path:`/samanlabs-seo/v1/404-log/${e.id}/ignore`,method:"DELETE"}),a(t=>t.map(t=>t.id===e.id?{...t,is_ignored:!1}:t)),j(e=>Math.max(0,e-1))}catch(e){console.error("Failed to unignore entry:",e)}finally{z(null)}})(e),disabled:W===e.id},W===e.id?"...":"Unignore"):(0,l.createElement)("button",{type:"button",className:"button ghost small",onClick:()=>(async e=>{z(e.id);try{await c()({path:`/samanlabs-seo/v1/404-log/${e.id}/ignore`,method:"POST"}),a(t=>t.map(t=>t.id===e.id?{...t,is_ignored:!0}:t)),j(e=>e+1),O||(a(t=>t.filter(t=>t.id!==e.id)),E(e=>Math.max(0,e-1)))}catch(e){console.error("Failed to ignore entry:",e)}finally{z(null)}})(e),disabled:W===e.id,title:"Ignore this URL"},W===e.id?"...":"Ignore"))))))),y>1&&(0,l.createElement)("div",{className:"pagination"},(0,l.createElement)("span",{className:"pagination-info"},u.toLocaleString()," ",1===u?"item":"items"),(0,l.createElement)("div",{className:"pagination-links"},(0,l.createElement)("button",{type:"button",className:"pagination-btn",disabled:b<=1,onClick:()=>h(b-1)},"‹ Previous"),(0,l.createElement)("span",{className:"pagination-current"},b," of ",y),(0,l.createElement)("button",{type:"button",className:"pagination-btn",disabled:b>=y,onClick:()=>h(b+1)},"Next ›"))))),U&&(0,l.createElement)(o,{entry:U,onClose:()=>F(null),onSuccess:e=>{F(null),e.entry_deleted?(a(t=>t.filter(t=>t.id!==e.redirect.id)),E(e=>Math.max(0,e-1))):a(t=>t.map(t=>t.request_uri===e.redirect.source?{...t,redirect_exists:!0}:t)),G()}}),I&&(0,l.createElement)(m,{onClose:()=>A(!1),onPatternChange:()=>G()}))}}}]);